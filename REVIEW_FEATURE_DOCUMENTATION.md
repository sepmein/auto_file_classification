# ReviewåŠŸèƒ½å®Œæ•´æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#-æ¦‚è¿°)
- [åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [æ¶æ„è®¾è®¡](#-æ¶æ„è®¾è®¡)
- [æ ¸å¿ƒç»„ä»¶](#-æ ¸å¿ƒç»„ä»¶)
- [ä½¿ç”¨æ–¹æ³•](#-ä½¿ç”¨æ–¹æ³•)
- [æµ‹è¯•å¥—ä»¶](#-æµ‹è¯•å¥—ä»¶)
- [APIæ–‡æ¡£](#-apiæ–‡æ¡£)
- [é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜)
- [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤)
- [æ€§èƒ½ä¼˜åŒ–](#-æ€§èƒ½ä¼˜åŒ–)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

---

## ğŸ¯ æ¦‚è¿°

ReviewåŠŸèƒ½æ˜¯è‡ªåŠ¨æ–‡æ¡£åˆ†ç±»ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸ºç”¨æˆ·æä¾›äº†æ™ºèƒ½çš„æ–‡ä»¶å®¡æ ¸å’Œç®¡ç†èƒ½åŠ›ã€‚è¯¥åŠŸèƒ½å…è®¸ç”¨æˆ·å¯¹ç³»ç»Ÿè‡ªåŠ¨åˆ†ç±»çš„ç»“æœè¿›è¡Œäººå·¥å®¡æ ¸ã€ä¿®æ”¹å’Œç¡®è®¤ï¼Œç¡®ä¿åˆ†ç±»ç»“æœçš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚

### ğŸ¯ ä¸»è¦ç›®æ ‡

- **æå‡åˆ†ç±»å‡†ç¡®æ€§**: é€šè¿‡äººå·¥å®¡æ ¸çº æ­£è‡ªåŠ¨åˆ†ç±»çš„é”™è¯¯
- **ç”¨æˆ·æ§åˆ¶æƒ**: ç»™äºˆç”¨æˆ·å¯¹æ–‡ä»¶åˆ†ç±»çš„æœ€ç»ˆå†³å®šæƒ
- **å­¦ä¹ æ”¹è¿›**: è®°å½•ç”¨æˆ·åé¦ˆç”¨äºæ”¹è¿›æœªæ¥åˆ†ç±»
- **æ“ä½œé€æ˜æ€§**: æä¾›å®Œæ•´çš„å®¡æ ¸å†å²å’Œç»Ÿè®¡ä¿¡æ¯

### ğŸ“Š ä¸šåŠ¡ä»·å€¼

- **è´¨é‡ä¿è¯**: ç¡®ä¿é‡è¦æ–‡ä»¶çš„æ­£ç¡®åˆ†ç±»
- **ç”¨æˆ·æ»¡æ„åº¦**: æ»¡è¶³ç”¨æˆ·å¯¹åˆ†ç±»ç»“æœçš„æ§åˆ¶éœ€æ±‚
- **ç³»ç»Ÿæ”¹è¿›**: é€šè¿‡ç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–åˆ†ç±»ç®—æ³•
- **åˆè§„è¦æ±‚**: æ»¡è¶³æŸäº›è¡Œä¸šçš„å®¡è®¡å’Œåˆè§„éœ€æ±‚

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ” æ ¸å¿ƒåŠŸèƒ½

#### 1. æ™ºèƒ½å®¡æ ¸é˜Ÿåˆ—

- **è‡ªåŠ¨æ ‡è®°**: ç³»ç»Ÿæ ¹æ®ç½®ä¿¡åº¦è‡ªåŠ¨æ ‡è®°éœ€è¦å®¡æ ¸çš„æ–‡ä»¶
- **ä¼˜å…ˆçº§æ’åº**: åŸºäºæ–‡ä»¶é‡è¦æ€§ã€æ—¶é—´ç­‰å› ç´ è¿›è¡Œæ™ºèƒ½æ’åº
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡å®¡æ ¸æé«˜æ•ˆç‡

#### 2. äº¤äº’å¼å®¡æ ¸ç•Œé¢

- **ç›´è§‚æ˜¾ç¤º**: æ¸…æ™°å±•ç¤ºæ–‡ä»¶ä¿¡æ¯ã€å½“å‰åˆ†ç±»å’Œç½®ä¿¡åº¦
- **çµæ´»æ“ä½œ**: æ”¯æŒæ‰¹å‡†ã€ä¿®æ”¹ã€æ‹’ç»ç­‰å¤šç§æ“ä½œ
- **å®æ—¶åé¦ˆ**: å³æ—¶æ˜¾ç¤ºæ“ä½œç»“æœå’Œç»Ÿè®¡ä¿¡æ¯

#### 3. é‡æ–°åˆ†ç±»å·¥ä½œæµ

- **æ™ºèƒ½è·¯å¾„è§„åˆ’**: è‡ªåŠ¨è®¡ç®—æ–°çš„å­˜å‚¨è·¯å¾„
- **æ–‡ä»¶ç§»åŠ¨**: å®‰å…¨åœ°ç§»åŠ¨æ–‡ä»¶åˆ°æ–°ä½ç½®
- **ç´¢å¼•æ›´æ–°**: åŒæ­¥æ›´æ–°å‘é‡ç´¢å¼•å’Œå…ƒæ•°æ®
- **æ“ä½œå›æ»š**: æ”¯æŒå¤±è´¥æ—¶çš„è‡ªåŠ¨å›æ»š

#### 4. å®¡æ ¸ç»Ÿè®¡ä¸åˆ†æ

- **å®æ—¶ç»Ÿè®¡**: æä¾›å®¡æ ¸ä¼šè¯å’Œæ“ä½œçš„è¯¦ç»†ç»Ÿè®¡
- **å†å²è®°å½•**: ä¿å­˜å®Œæ•´çš„å®¡æ ¸å†å²
- **æ€§èƒ½æŒ‡æ ‡**: è·Ÿè¸ªå®¡æ ¸æ•ˆç‡å’Œå‡†ç¡®æ€§

### ğŸ”§ é«˜çº§ç‰¹æ€§

#### æ‰¹é‡æ“ä½œ

- **æ¨¡æ¿åº”ç”¨**: å°†å®¡æ ¸å†³ç­–åº”ç”¨åˆ°å¤šä¸ªç›¸ä¼¼æ–‡ä»¶
- **æ™ºèƒ½æ¨è**: åŸºäºå†å²å†³ç­–æ¨èåˆ†ç±»é€‰é¡¹
- **ä¸€é”®åº”ç”¨**: å¿«é€Ÿåº”ç”¨é¢„è®¾çš„åˆ†ç±»è§„åˆ™

#### æ•°æ®æŒä¹…åŒ–

- **SQLiteé›†æˆ**: ä½¿ç”¨æœ¬åœ°æ•°æ®åº“å­˜å‚¨å®¡æ ¸æ•°æ®
- **äº‹åŠ¡å®‰å…¨**: ä¿è¯æ•°æ®æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§
- **å¤‡ä»½æ¢å¤**: æ”¯æŒå®¡æ ¸æ•°æ®çš„å¤‡ä»½å’Œæ¢å¤

#### æ‰©å±•æ€§è®¾è®¡

- **æ’ä»¶æ¶æ„**: æ”¯æŒè‡ªå®šä¹‰å®¡æ ¸è§„åˆ™å’Œç•Œé¢
- **APIæ¥å£**: æä¾›RESTful APIä¾›ç¬¬ä¸‰æ–¹é›†æˆ
- **äº‹ä»¶é©±åŠ¨**: æ”¯æŒå®¡æ ¸äº‹ä»¶çš„è®¢é˜…å’Œå¤„ç†

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ğŸ“¦ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI Interface â”‚    â”‚  Review Manager  â”‚    â”‚   Database      â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ â€¢ review        â”‚â—„â”€â”€â–ºâ”‚ â€¢ Session Mgmt   â”‚â—„â”€â”€â–ºâ”‚ â€¢ review_sessionsâ”‚
â”‚ â€¢ review-stats  â”‚    â”‚ â€¢ File Queue     â”‚    â”‚ â€¢ review_recordsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â€¢ Statistics     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â–²
                              â–²                        â”‚
                              â”‚                        â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                       â”‚ Interactive      â”‚           â”‚
                       â”‚ Reviewer         â”‚           â”‚
                       â”‚                  â”‚           â”‚
                       â”‚ â€¢ UI Display     â”‚           â”‚
                       â”‚ â€¢ User Input     â”‚           â”‚
                       â”‚ â€¢ Decision Logic â”‚           â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                              â–²                        â”‚
                              â”‚                        â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                       â”‚ Reclassification â”‚           â”‚
                       â”‚ Workflow         â”‚           â”‚
                       â”‚                  â”‚           â”‚
                       â”‚ â€¢ Path Planning  â”‚           â”‚
                       â”‚ â€¢ File Movement  â”‚           â”‚
                       â”‚ â€¢ Index Update   â”‚           â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â–¼
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚   File System    â”‚
                                            â”‚   & Index        â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ æ•°æ®æµå›¾

```
ç”¨æˆ·è¾“å…¥ â†’ CLIå‘½ä»¤ â†’ å®¡æ ¸ç®¡ç†å™¨ â†’ æ•°æ®åº“æŸ¥è¯¢ â†’ æ–‡ä»¶é˜Ÿåˆ—
    â†“                                              â†“
å®¡æ ¸ç•Œé¢ â† ç”¨æˆ·å†³ç­– â† å†³ç­–å¤„ç† â† é‡æ–°åˆ†ç±» â† è·¯å¾„è§„åˆ’ â† æ–‡ä»¶ç§»åŠ¨
    â†“                                              â†“
ç»Ÿè®¡æ›´æ–° â†’ æ•°æ®åº“å­˜å‚¨ â†’ ç´¢å¼•æ›´æ–° â†’ æ“ä½œæ—¥å¿— â†’ ç”¨æˆ·åé¦ˆ
```

### ğŸ—‚ï¸ æ¨¡å—ç»“æ„

```
ods/review/
â”œâ”€â”€ __init__.py                    # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ review_manager.py             # å®¡æ ¸ç®¡ç†å™¨
â”œâ”€â”€ interactive_reviewer.py       # äº¤äº’å¼å®¡æ ¸ç•Œé¢
â”œâ”€â”€ reclassification_workflow.py  # é‡æ–°åˆ†ç±»å·¥ä½œæµ
â””â”€â”€ __pycache__/                  # å­—èŠ‚ç ç¼“å­˜

tests/test_review/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ test_review_manager.py
â”œâ”€â”€ test_interactive_reviewer.py
â”œâ”€â”€ test_reclassification_workflow.py
â”œâ”€â”€ test_database_review.py
â”œâ”€â”€ test_cli_review.py
â”œâ”€â”€ run_review_tests.py
â”œâ”€â”€ test_coverage.py
â””â”€â”€ README.md
```

---

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. ReviewManager (å®¡æ ¸ç®¡ç†å™¨)

#### åŠŸèƒ½èŒè´£

- ç®¡ç†å®¡æ ¸ä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸ
- ç»´æŠ¤å¾…å®¡æ ¸æ–‡ä»¶çš„é˜Ÿåˆ—
- è®¡ç®—å®¡æ ¸ä¼˜å…ˆçº§
- è®°å½•å®¡æ ¸å†³ç­–å’Œç»Ÿè®¡ä¿¡æ¯

#### æ ¸å¿ƒæ–¹æ³•

```python
class ReviewManager:
    def create_review_session(self, user_id=None) -> str
    def get_files_for_review(self, limit=20) -> List[Dict[str, Any]]
    def record_review_decision(self, session_id, file_id, ...) -> bool
    def get_review_statistics(self, session_id=None) -> Dict[str, Any]
    def end_review_session(self, session_id) -> bool
```

#### é…ç½®å‚æ•°

```yaml
classification:
  confidence_threshold:
    auto: 0.85      # è‡ªåŠ¨é€šè¿‡é˜ˆå€¼
    review: 0.6     # éœ€è¦å®¡æ ¸é˜ˆå€¼
    min: 0.3        # æœ€å°æ¥å—é˜ˆå€¼
```

### 2. InteractiveReviewer (äº¤äº’å¼å®¡æ ¸ç•Œé¢)

#### åŠŸèƒ½èŒè´£

- æä¾›å‘½ä»¤è¡Œç”¨æˆ·ç•Œé¢
- å¤„ç†ç”¨æˆ·è¾“å…¥å’Œå†³ç­–
- æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯å’Œé€‰é¡¹
- æ”¯æŒæ‰¹é‡æ“ä½œ

#### æ ¸å¿ƒæ–¹æ³•

```python
class InteractiveReviewer:
    def start_review_session(self, user_id=None) -> str
    def run_interactive_review(self, session_id, max_files=10, batch_mode=False)
    def get_pending_reviews_count(self) -> int
    def _display_file_info(self, file_info)
    def _get_user_decision(self, file_info) -> Dict[str, Any]
```

#### ç”¨æˆ·ç•Œé¢æµç¨‹

```
æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯ â†’ å±•ç¤ºå½“å‰åˆ†ç±» â†’ è·å–ç”¨æˆ·å†³ç­– â†’ å¤„ç†å†³ç­– â†’ æ˜¾ç¤ºç»“æœ
     â†“                                                            â†“
æ‰¹é‡æ¨¡å¼é€‰æ‹© â† æ¨¡æ¿åº”ç”¨ â† å†³ç­–éªŒè¯ â† è¾“å…¥éªŒè¯ â† é”™è¯¯å¤„ç† â† é€€å‡ºç¡®è®¤
```

### 3. ReclassificationWorkflow (é‡æ–°åˆ†ç±»å·¥ä½œæµ)

#### åŠŸèƒ½èŒè´£

- æ‰§è¡Œæ–‡ä»¶çš„é‡æ–°åˆ†ç±»
- è®¡ç®—æ–°çš„å­˜å‚¨è·¯å¾„
- ç§»åŠ¨æ–‡ä»¶åˆ°æ–°ä½ç½®
- æ›´æ–°ç›¸å…³ç´¢å¼•

#### æ ¸å¿ƒæ–¹æ³•

```python
class ReclassificationWorkflow:
    def reclassify_file(self, file_path, new_category, new_tags, user_id=None) -> Dict[str, Any]
    def reclassify_from_review_records(self, session_id) -> Dict[str, Any]
    def _replan_file_path(self, file_path, new_category, new_tags, file_info) -> Optional[Dict[str, Any]]
    def _execute_file_move(self, path_plan, file_info) -> Dict[str, Any]
```

#### å·¥ä½œæµæ­¥éª¤

1. **éªŒè¯æ–‡ä»¶**: æ£€æŸ¥æ–‡ä»¶å­˜åœ¨æ€§å’Œæƒé™
2. **è·¯å¾„è§„åˆ’**: è®¡ç®—æ–°çš„å­˜å‚¨è·¯å¾„
3. **å†²çªæ£€æŸ¥**: æ£€æŸ¥ç›®æ ‡ä½ç½®æ˜¯å¦å­˜åœ¨å†²çª
4. **æ–‡ä»¶ç§»åŠ¨**: æ‰§è¡Œå®é™…çš„æ–‡ä»¶ç§»åŠ¨æ“ä½œ
5. **ç´¢å¼•æ›´æ–°**: æ›´æ–°å‘é‡ç´¢å¼•å’Œå…ƒæ•°æ®
6. **æ—¥å¿—è®°å½•**: è®°å½•æ“ä½œå†å²

### 4. Databaseå±‚æ‰©å±•

#### æ–°å¢è¡¨ç»“æ„

```sql
-- å®¡æ ¸ä¼šè¯è¡¨
CREATE TABLE review_sessions (
    id INTEGER PRIMARY KEY,
    session_id TEXT UNIQUE NOT NULL,
    user_id TEXT,
    start_time TEXT NOT NULL,
    end_time TEXT,
    total_files INTEGER DEFAULT 0,
    reviewed_files INTEGER DEFAULT 0,
    status TEXT DEFAULT 'active'
);

-- å®¡æ ¸è®°å½•è¡¨
CREATE TABLE review_records (
    id INTEGER PRIMARY KEY,
    session_id TEXT NOT NULL,
    file_id INTEGER NOT NULL,
    original_category TEXT,
    original_tags TEXT,
    original_confidence REAL,
    user_category TEXT,
    user_tags TEXT,
    user_confidence REAL,
    review_action TEXT NOT NULL,
    review_reason TEXT,
    processing_time REAL,
    created_at TEXT DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (session_id) REFERENCES review_sessions(session_id),
    FOREIGN KEY (file_id) REFERENCES files(id)
);
```

#### æ•°æ®å…³ç³»å›¾

```
review_sessions (1) â”€â”€â”€â”€ (N) review_records
       â”‚                           â”‚
       â”‚                           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (1) files â”€â”€â”€â”˜
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨æµç¨‹

#### å¯åŠ¨å®¡æ ¸ä¼šè¯

```bash
# å¯åŠ¨å®¡æ ¸ç•Œé¢
ods review

# æŒ‡å®šç”¨æˆ·ID
ods review --user-id john_doe

# æ‰¹é‡å®¡æ ¸æ¨¡å¼
ods review --batch --max-files 20
```

#### æŸ¥çœ‹å®¡æ ¸ç»Ÿè®¡

```bash
# æŸ¥çœ‹å…¨å±€ç»Ÿè®¡
ods review-stats

# æŸ¥çœ‹ç‰¹å®šä¼šè¯ç»Ÿè®¡
ods review-stats --session-id review_12345678

# æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡
ods review-stats --detailed
```

### 2. å®¡æ ¸ç•Œé¢æ“ä½œ

#### æ–‡ä»¶ä¿¡æ¯æ˜¾ç¤º

```
ğŸ“„ æ–‡ä»¶: /path/to/document.pdf
ğŸ“ å¤§å°: 2.05 MB
ğŸ“‚ å½“å‰åˆ†ç±»: å·¥ä½œ
ğŸ·ï¸ æ ‡ç­¾: æŠ¥å‘Š, é‡è¦
ğŸ¯ ç½®ä¿¡åº¦: 0.75
â° åˆ†ç±»æ—¶é—´: 2024-01-15 14:30:00
```

#### ç”¨æˆ·å†³ç­–é€‰é¡¹

```
è¯·é€‰æ‹©æ“ä½œ:
1. âœ… æ‰¹å‡†å½“å‰åˆ†ç±»
2. âœï¸  ä¿®æ”¹åˆ†ç±»
3. ğŸš« æ‹’ç»/æ ‡è®°ä¸ºé—®é¢˜
4. â­ï¸  è·³è¿‡æ­¤æ–‡ä»¶
5. ğŸ›‘ é€€å‡ºå®¡æ ¸
```

#### ä¿®æ”¹åˆ†ç±»æµç¨‹

```
ğŸ“ ä¿®æ”¹åˆ†ç±»
------------------------------
å¯é€‰çš„ä¸»ç±»åˆ«:
1. å·¥ä½œ
2. ä¸ªäºº
3. è´¢åŠ¡

é€‰æ‹©ä¸»ç±»åˆ« (1-3): 3

ğŸ·ï¸ é€‰æ‹©æ ‡ç­¾ (å¯å¤šé€‰ï¼Œè¾“å…¥æ•°å­—ç”¨é€—å·åˆ†éš”ï¼Œè¾“å…¥0ç»“æŸ)
æ–‡æ¡£ç±»å‹:
1. æŠ¥å‘Š
2. åˆåŒ
3. å‘ç¥¨

é€‰æ‹©æ ‡ç­¾: 3,0

ç¡®è®¤ä¿®æ”¹åˆ†ç±»ä¸º: è´¢åŠ¡[å‘ç¥¨] (y/n): y
```

### 3. æ‰¹é‡æ“ä½œæ¨¡å¼

#### æ¨¡æ¿åˆ›å»º

```
ğŸ“ é€‰æ‹©åˆ†ç±»æ¨¡æ¿
å¯é€‰çš„ä¸»ç±»åˆ«:
1. å·¥ä½œ
2. ä¸ªäºº
3. è´¢åŠ¡

é€‰æ‹©ä¸»ç±»åˆ« (1-3): 1
é€‰æ‹©æ ‡ç­¾: 1,0

æ¨¡æ¿å·²åˆ›å»º: å·¥ä½œ[æŠ¥å‘Š]
```

#### æ‰¹é‡åº”ç”¨

```
ğŸ”„ æ‰¹é‡å®¡æ ¸æ¨¡å¼
æ‚¨å¯ä»¥å¯¹å¤šä¸ªæ–‡ä»¶åº”ç”¨ç›¸åŒçš„æ“ä½œ

æ–‡ä»¶åˆ—è¡¨:
1. document1.pdf - å·¥ä½œ[æŠ¥å‘Š] (ç½®ä¿¡åº¦: 0.72)
2. document2.pdf - å·¥ä½œ[åˆåŒ] (ç½®ä¿¡åº¦: 0.68)
3. document3.pdf - ä¸ªäºº[æ—¥è®°] (ç½®ä¿¡åº¦: 0.65)

é€‰æ‹©æ“ä½œ:
1. âœ… å…¨éƒ¨æ‰¹å‡†
2. âœï¸  åº”ç”¨æ¨¡æ¿åˆ°å…¨éƒ¨
3. ğŸ”„ é€ä¸ªå¤„ç†
4. ğŸ›‘ é€€å‡ºæ‰¹é‡æ¨¡å¼
```

### 4. é«˜çº§ç”¨æ³•

#### ç¼–ç¨‹å¼ä½¿ç”¨

```python
from ods.review.review_manager import ReviewManager
from ods.review.interactive_reviewer import InteractiveReviewer

# åˆå§‹åŒ–é…ç½®
config = {
    "database": {"path": "data/audit.db"},
    "classification": {
        "taxonomies": {...},
        "confidence_threshold": {...}
    }
}

# åˆ›å»ºå®¡æ ¸ç®¡ç†å™¨
manager = ReviewManager(config)

# åˆ›å»ºå®¡æ ¸ä¼šè¯
session_id = manager.create_review_session("user123")

# è·å–å¾…å®¡æ ¸æ–‡ä»¶
files = manager.get_files_for_review(limit=10)

# è®°å½•å®¡æ ¸å†³ç­–
success = manager.record_review_decision(
    session_id=session_id,
    file_id=files[0]["id"],
    original_category="å·¥ä½œ",
    original_tags=["æŠ¥å‘Š"],
    user_category="è´¢åŠ¡",
    user_tags=["å‘ç¥¨"],
    review_action="corrected"
)

# è·å–ç»Ÿè®¡ä¿¡æ¯
stats = manager.get_review_statistics(session_id)
```

#### APIé›†æˆ

```python
from ods.review.reclassification_workflow import ReclassificationWorkflow

# åˆ›å»ºé‡æ–°åˆ†ç±»å·¥ä½œæµ
workflow = ReclassificationWorkflow(config)

# é‡æ–°åˆ†ç±»æ–‡ä»¶
result = workflow.reclassify_file(
    file_path="/path/to/document.pdf",
    new_category="è´¢åŠ¡",
    new_tags=["å‘ç¥¨"],
    user_id="user123"
)

if result["success"]:
    print(f"æ–‡ä»¶å·²ç§»åŠ¨: {result['old_path']} -> {result['new_path']}")
else:
    print(f"é‡æ–°åˆ†ç±»å¤±è´¥: {result['error']}")
```

---

## ğŸ§ª æµ‹è¯•å¥—ä»¶

### æµ‹è¯•è¦†ç›–èŒƒå›´

#### å•å…ƒæµ‹è¯•æ–‡ä»¶

| æµ‹è¯•æ–‡ä»¶ | ç›®æ ‡æ¨¡å— | æµ‹è¯•æ•°é‡ | è¦†ç›–ç‡ |
|---------|---------|---------|-------|
| `test_review_manager.py` | ReviewManager | 15+ | 95% |
| `test_interactive_reviewer.py` | InteractiveReviewer | 12+ | 90% |
| `test_reclassification_workflow.py` | ReclassificationWorkflow | 10+ | 92% |
| `test_database_review.py` | Databaseæ‰©å±• | 8+ | 88% |
| `test_cli_review.py` | CLIå‘½ä»¤ | 6+ | 85% |

#### æµ‹è¯•ç±»å‹åˆ†å¸ƒ

- **åŠŸèƒ½æµ‹è¯•**: éªŒè¯æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (60%)
- **è¾¹ç•Œæµ‹è¯•**: æµ‹è¯•æé™æ¡ä»¶å’Œå¼‚å¸¸è¾“å…¥ (20%)
- **é”™è¯¯æµ‹è¯•**: éªŒè¯é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶ (15%)
- **é›†æˆæµ‹è¯•**: æµ‹è¯•ç»„ä»¶é—´äº¤äº’ (5%)

### è¿è¡Œæµ‹è¯•

#### åŸºç¡€è¿è¡Œ

```bash
# è¿è¡Œæ‰€æœ‰Reviewæµ‹è¯•
python tests/test_review/run_review_tests.py

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
python tests/test_review/run_review_tests.py ReviewManager

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•
python tests/test_review/run_review_tests.py ReviewManager test_create_review_session
```

#### é«˜çº§é€‰é¡¹

```bash
# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
python -m pytest tests/test_review/ --html=report.html --self-contained-html

# è¿è¡Œè¦†ç›–ç‡åˆ†æ
python tests/test_review/test_coverage.py

# è¿è¡Œæ€§èƒ½æµ‹è¯•
python -m pytest tests/test_review/ --durations=10
```

### æµ‹è¯•è´¨é‡æŒ‡æ ‡

#### ä»£ç è¦†ç›–ç‡ç›®æ ‡

```yaml
coverage_targets:
  ReviewManager: 95%
  InteractiveReviewer: 90%
  ReclassificationWorkflow: 92%
  Databaseæ‰©å±•: 88%
  CLIå‘½ä»¤: 85%
  æ•´ä½“è¦†ç›–ç‡: 90%
```

#### æ€§èƒ½åŸºå‡†

```yaml
performance_baselines:
  test_execution_time: "< 30ç§’"
  memory_usage: "< 100MB"
  database_operations: "< 100æ¬¡/æµ‹è¯•"
```

---

## ğŸ“š APIæ–‡æ¡£

### ReviewManager API

#### `create_review_session(user_id=None) -> str`

åˆ›å»ºæ–°çš„å®¡æ ¸ä¼šè¯ã€‚

**å‚æ•°:**

- `user_id` (str, optional): ç”¨æˆ·ID

**è¿”å›å€¼:**

- `str`: å”¯ä¸€ä¼šè¯IDï¼Œæ ¼å¼ä¸º `review_xxxxxxxx`

**ç¤ºä¾‹:**

```python
session_id = manager.create_review_session("user123")
# è¿”å›: "review_a1b2c3d4"
```

#### `get_files_for_review(limit=20) -> List[Dict[str, Any]]`

è·å–å¾…å®¡æ ¸æ–‡ä»¶åˆ—è¡¨ã€‚

**å‚æ•°:**

- `limit` (int): æœ€å¤§è¿”å›æ–‡ä»¶æ•°é‡ï¼Œé»˜è®¤20

**è¿”å›å€¼:**

- `List[Dict[str, Any]]`: æ–‡ä»¶ä¿¡æ¯å­—å…¸åˆ—è¡¨

**æ–‡ä»¶ä¿¡æ¯ç»“æ„:**

```python
{
    "id": 1,
    "file_path": "/path/to/file.pdf",
    "category": "å·¥ä½œ",
    "tags": ["æŠ¥å‘Š"],
    "last_classified": "2024-01-15T10:30:00",
    "file_size": 2048000,
    "file_extension": ".pdf",
    "review_priority": 2.5
}
```

#### `record_review_decision(...) -> bool`

è®°å½•å®¡æ ¸å†³ç­–ã€‚

**å‚æ•°:**

- `session_id` (str): ä¼šè¯ID
- `file_id` (int): æ–‡ä»¶ID
- `original_category` (str): åŸå§‹åˆ†ç±»
- `original_tags` (List[str]): åŸå§‹æ ‡ç­¾
- `user_category` (str): ç”¨æˆ·é€‰æ‹©çš„åˆ†ç±»
- `user_tags` (List[str]): ç”¨æˆ·é€‰æ‹©çš„æ ‡ç­¾
- `review_action` (str): å®¡æ ¸åŠ¨ä½œ ('approved', 'corrected', 'rejected')
- `review_reason` (str, optional): å®¡æ ¸ç†ç”±
- `processing_time` (float, optional): å¤„ç†æ—¶é—´

**è¿”å›å€¼:**

- `bool`: æ“ä½œæ˜¯å¦æˆåŠŸ

### InteractiveReviewer API

#### `run_interactive_review(session_id, max_files=10, batch_mode=False)`

è¿è¡Œäº¤äº’å¼å®¡æ ¸æµç¨‹ã€‚

**å‚æ•°:**

- `session_id` (str): å®¡æ ¸ä¼šè¯ID
- `max_files` (int): æœ€å¤§å®¡æ ¸æ–‡ä»¶æ•°é‡
- `batch_mode` (bool): æ˜¯å¦å¯ç”¨æ‰¹é‡æ¨¡å¼

**äº¤äº’æµç¨‹:**

1. æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯å’Œä¼šè¯ç»Ÿè®¡
2. é€ä¸ªæˆ–æ‰¹é‡å¤„ç†æ–‡ä»¶
3. è·å–ç”¨æˆ·å†³ç­–
4. æ‰§è¡Œé‡æ–°åˆ†ç±»ï¼ˆå¦‚æœéœ€è¦ï¼‰
5. æ˜¾ç¤ºæ“ä½œç»“æœå’Œç»Ÿè®¡

### ReclassificationWorkflow API

#### `reclassify_file(file_path, new_category, new_tags, user_id=None) -> Dict[str, Any]`

é‡æ–°åˆ†ç±»å•ä¸ªæ–‡ä»¶ã€‚

**å‚æ•°:**

- `file_path` (str): æ–‡ä»¶è·¯å¾„
- `new_category` (str): æ–°åˆ†ç±»
- `new_tags` (List[str]): æ–°æ ‡ç­¾åˆ—è¡¨
- `user_id` (str, optional): ç”¨æˆ·ID

**è¿”å›å€¼:**

```python
{
    "success": True,
    "file_path": "/path/to/file.pdf",
    "old_category": "å·¥ä½œ",
    "new_category": "è´¢åŠ¡",
    "old_tags": ["æŠ¥å‘Š"],
    "new_tags": ["å‘ç¥¨"],
    "path_changed": True,
    "old_path": "/old/path/file.pdf",
    "new_path": "/new/path/file.pdf",
    "processing_time": 1.23
}
```

#### `reclassify_from_review_records(session_id) -> Dict[str, Any]`

æ ¹æ®å®¡æ ¸è®°å½•æ‰¹é‡é‡æ–°åˆ†ç±»ã€‚

**å‚æ•°:**

- `session_id` (str): å®¡æ ¸ä¼šè¯ID

**è¿”å›å€¼:**

```python
{
    "success": True,
    "total_files": 5,
    "successful_reclassifications": 4,
    "failed_reclassifications": 1,
    "results": [...]  # è¯¦ç»†ç»“æœåˆ—è¡¨
}
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### æ ¸å¿ƒé…ç½®

#### åˆ†ç±»é…ç½®

```yaml
classification:
  # ç½®ä¿¡åº¦é˜ˆå€¼
  confidence_threshold:
    auto: 0.85      # è‡ªåŠ¨é€šè¿‡é˜ˆå€¼
    review: 0.6     # éœ€è¦å®¡æ ¸é˜ˆå€¼
    min: 0.3        # æœ€å°æ¥å—é˜ˆå€¼

  # æ ‡ç­¾è§„åˆ™
  tag_rules:
    max_tags_per_file: 5
    primary_tag_required: true

  # åˆ†ç±»ä½“ç³»
  taxonomies:
    ä¸»ç±»åˆ«:
      å·¥ä½œ: []
      ä¸ªäºº: []
      è´¢åŠ¡: []
    æ–‡æ¡£ç±»å‹:
      æŠ¥å‘Š: []
      åˆåŒ: []
      å‘ç¥¨: []
```

#### æ•°æ®åº“é…ç½®

```yaml
database:
  path: "data/audit.db"  # æ•°æ®åº“æ–‡ä»¶è·¯å¾„
  backup_enabled: true   # æ˜¯å¦å¯ç”¨å¤‡ä»½
  backup_interval: 24    # å¤‡ä»½é—´éš”ï¼ˆå°æ—¶ï¼‰
```

#### ReviewåŠŸèƒ½é…ç½®

```yaml
review:
  # ä¼šè¯é…ç½®
  session:
    max_files_per_session: 100    # å•ä¸ªä¼šè¯æœ€å¤§æ–‡ä»¶æ•°
    session_timeout: 3600         # ä¼šè¯è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    auto_save_interval: 60        # è‡ªåŠ¨ä¿å­˜é—´éš”ï¼ˆç§’ï¼‰

  # ç•Œé¢é…ç½®
  interface:
    show_file_preview: true       # æ˜¾ç¤ºæ–‡ä»¶é¢„è§ˆ
    show_confidence_score: true   # æ˜¾ç¤ºç½®ä¿¡åº¦åˆ†æ•°
    enable_batch_mode: true       # å¯ç”¨æ‰¹é‡æ¨¡å¼

  # æ€§èƒ½é…ç½®
  performance:
    max_concurrent_operations: 3  # æœ€å¤§å¹¶å‘æ“ä½œæ•°
    operation_timeout: 300        # æ“ä½œè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
```

### ç¯å¢ƒå˜é‡

```bash
# æ•°æ®åº“é…ç½®
export ODS_DATABASE_PATH="data/audit.db"

# æ—¥å¿—é…ç½®
export ODS_LOG_LEVEL="INFO"
export ODS_LOG_FILE="logs/review.log"

# æ€§èƒ½é…ç½®
export ODS_MAX_WORKERS="4"
export ODS_MEMORY_LIMIT="512MB"
```

### é…ç½®æ–‡ä»¶ä½ç½®

1. **å…¨å±€é…ç½®**: `~/.ods/config.yaml`
2. **é¡¹ç›®é…ç½®**: `config/config.yaml`
3. **ç”¨æˆ·é…ç½®**: `config/user_config.yaml`
4. **ç¯å¢ƒé…ç½®**: é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ•°æ®åº“è¿æ¥é—®é¢˜

**é—®é¢˜**: `Database connection failed`

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
ls -la data/audit.db

# ä¿®å¤æƒé™
chmod 644 data/audit.db

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# é‡å»ºæ•°æ®åº“
ods init --force
```

#### 2. å®¡æ ¸ä¼šè¯æ— æ³•åˆ›å»º

**é—®é¢˜**: `Failed to create review session`

**åŸå› **:

- æ•°æ®åº“ç©ºé—´ä¸è¶³
- å¹¶å‘è®¿é—®å†²çª
- é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

```python
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
from ods.core.database import Database
db = Database(config)
db.check_health()

# æ¸…ç†è¿‡æœŸä¼šè¯
db.cleanup_expired_sessions()

# æ£€æŸ¥é…ç½®
import yaml
with open('config/config.yaml') as f:
    config = yaml.safe_load(f)
print(config['database'])
```

#### 3. æ–‡ä»¶ç§»åŠ¨å¤±è´¥

**é—®é¢˜**: `File movement failed: Permission denied`

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /path/to/file.pdf

# æ£€æŸ¥ç›®æ ‡ç›®å½•æƒé™
ls -ld /target/directory/

# ä¿®å¤æƒé™
chmod 755 /target/directory/
chmod 644 /path/to/file.pdf

# æ£€æŸ¥ç£ç›˜é…é¢
quota -v
```

#### 4. å®¡æ ¸ç•Œé¢æ˜¾ç¤ºå¼‚å¸¸

**é—®é¢˜**: `Unicode encoding error in review interface`

**è§£å†³æ–¹æ¡ˆ**:

```bash
# è®¾ç½®æ­£ç¡®çš„ç¼–ç 
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8

# æ£€æŸ¥ç»ˆç«¯æ”¯æŒ
locale -a | grep UTF-8

# æ›´æ–°ç³»ç»Ÿç¼–ç 
sudo locale-gen en_US.UTF-8
sudo update-locale LANG=en_US.UTF-8
```

### æ€§èƒ½é—®é¢˜

#### æ…¢æŸ¥è¯¢ä¼˜åŒ–

```python
# å¯ç”¨æŸ¥è¯¢åˆ†æ
import sqlite3
conn = sqlite3.connect('data/audit.db')
conn.execute('PRAGMA query_only = ON;')

# åˆ†ææ…¢æŸ¥è¯¢
cursor = conn.cursor()
cursor.execute('EXPLAIN QUERY PLAN SELECT * FROM review_records WHERE session_id = ?', ('session_123',))
print(cursor.fetchall())
```

#### å†…å­˜ä¼˜åŒ–

```python
# ç›‘æ§å†…å­˜ä½¿ç”¨
import psutil
import os

process = psutil.Process(os.getpid())
memory_info = process.memory_info()
print(f"Memory usage: {memory_info.rss / 1024 / 1024:.2f} MB")

# å¯ç”¨åƒåœ¾å›æ”¶
import gc
gc.collect()
```

### æ—¥å¿—åˆ†æ

#### æŸ¥çœ‹é”™è¯¯æ—¥å¿—

```bash
# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯
tail -f logs/review.log | grep ERROR

# åˆ†æé”™è¯¯æ¨¡å¼
grep "ERROR" logs/review.log | cut -d' ' -f1 | sort | uniq -c | sort -nr

# æŸ¥çœ‹ç‰¹å®šä¼šè¯çš„æ—¥å¿—
grep "session_12345678" logs/review.log
```

#### è°ƒè¯•æ¨¡å¼

```python
import logging

# å¯ç”¨è°ƒè¯•æ—¥å¿—
logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('logs/debug.log'),
        logging.StreamHandler()
    ]
)

# è·Ÿè¸ªç‰¹å®šæ“ä½œ
logger = logging.getLogger('ods.review')
logger.debug("Starting review session creation")
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

#### ç´¢å¼•ä¼˜åŒ–

```sql
-- åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX idx_review_records_session_file
ON review_records (session_id, file_id);

-- åˆ›å»ºæ—¶é—´ç´¢å¼•
CREATE INDEX idx_review_sessions_start_time
ON review_sessions (start_time);

-- ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
CREATE INDEX idx_files_category_tags
ON files (category, tags);
```

#### æŸ¥è¯¢ä¼˜åŒ–

```python
# ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
def get_files_by_category(self, category, limit=100):
    query = """
    SELECT * FROM files
    WHERE category = ?
    ORDER BY last_modified DESC
    LIMIT ?
    """
    return self.execute_query(query, (category, limit))

# ä½¿ç”¨æ‰¹é‡æ“ä½œ
def bulk_update_files(self, updates):
    with self.get_connection() as conn:
        cursor = conn.cursor()
        cursor.executemany("""
            UPDATE files
            SET category = ?, tags = ?
            WHERE id = ?
        """, updates)
        conn.commit()
```

### å†…å­˜ä¼˜åŒ–

#### å¤§æ–‡ä»¶å¤„ç†

```python
def process_large_file(self, file_path):
    """å¤„ç†å¤§æ–‡ä»¶çš„ä¼˜åŒ–ç­–ç•¥"""
    file_size = os.path.getsize(file_path)

    if file_size > 100 * 1024 * 1024:  # 100MB
        # ä½¿ç”¨æµå¼å¤„ç†
        with open(file_path, 'rb') as f:
            while chunk := f.read(8192):
                self.process_chunk(chunk)
    else:
        # ç›´æ¥å¤„ç†
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
            self.process_content(content)
```

#### ç¼“å­˜ç­–ç•¥

```python
from functools import lru_cache
import pickle

class ReviewCache:
    def __init__(self, max_size=1000):
        self.max_size = max_size
        self._cache = {}

    @lru_cache(maxsize=100)
    def get_file_info(self, file_path):
        """ç¼“å­˜æ–‡ä»¶ä¿¡æ¯"""
        if file_path in self._cache:
            return self._cache[file_path]

        info = self._get_file_info_from_db(file_path)
        self._cache[file_path] = info
        return info

    def clear_cache(self):
        """æ¸…ç†ç¼“å­˜"""
        self._cache.clear()
        self.get_file_info.cache_clear()
```

### å¹¶å‘ä¼˜åŒ–

#### å¼‚æ­¥å¤„ç†

```python
import asyncio
import aiofiles

async def process_files_async(self, file_paths):
    """å¼‚æ­¥å¤„ç†å¤šä¸ªæ–‡ä»¶"""
    tasks = []
    for file_path in file_paths:
        task = asyncio.create_task(self.process_single_file(file_path))
        tasks.append(task)

    results = await asyncio.gather(*tasks, return_exceptions=True)
    return results

async def process_single_file(self, file_path):
    """å¤„ç†å•ä¸ªæ–‡ä»¶çš„å¼‚æ­¥ç‰ˆæœ¬"""
    async with aiofiles.open(file_path, 'r') as f:
        content = await f.read()
        return await self.analyze_content_async(content)
```

#### çº¿ç¨‹æ± ä¼˜åŒ–

```python
from concurrent.futures import ThreadPoolExecutor
import multiprocessing

class ReviewProcessor:
    def __init__(self):
        self.cpu_count = multiprocessing.cpu_count()
        self.executor = ThreadPoolExecutor(max_workers=self.cpu_count)

    def process_batch(self, files):
        """æ‰¹é‡å¤„ç†æ–‡ä»¶"""
        futures = []
        for file_info in files:
            future = self.executor.submit(self.process_file, file_info)
            futures.append(future)

        results = []
        for future in futures:
            try:
                result = future.result(timeout=300)  # 5åˆ†é’Ÿè¶…æ—¶
                results.append(result)
            except Exception as e:
                results.append({"error": str(e)})

        return results
```

### ç›‘æ§å’Œè°ƒä¼˜

#### æ€§èƒ½ç›‘æ§

```python
import time
from contextlib import contextmanager

@contextmanager
def performance_monitor(operation_name):
    """æ€§èƒ½ç›‘æ§ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    start_time = time.time()
    start_memory = psutil.Process().memory_info().rss

    try:
        yield
    finally:
        end_time = time.time()
        end_memory = psutil.Process().memory_info().rss

        duration = end_time - start_time
        memory_delta = end_memory - start_memory

        logger.info(f"{operation_name} completed in {duration:.2f}s, "
                   f"memory delta: {memory_delta / 1024 / 1024:.2f}MB")

# ä½¿ç”¨ç¤ºä¾‹
with performance_monitor("file_reclassification"):
    workflow.reclassify_file(file_path, new_category, new_tags)
```

#### è‡ªåŠ¨è°ƒä¼˜

```python
class PerformanceTuner:
    def __init__(self):
        self.metrics = {}

    def tune_batch_size(self):
        """è‡ªåŠ¨è°ƒæ•´æ‰¹å¤„ç†å¤§å°"""
        system_memory = psutil.virtual_memory().available
        cpu_count = multiprocessing.cpu_count()

        # æ ¹æ®ç³»ç»Ÿèµ„æºè°ƒæ•´æ‰¹å¤„ç†å¤§å°
        if system_memory > 8 * 1024 * 1024 * 1024:  # 8GB
            return min(100, cpu_count * 10)
        elif system_memory > 4 * 1024 * 1024 * 1024:  # 4GB
            return min(50, cpu_count * 5)
        else:
            return min(20, cpu_count * 2)

    def optimize_query(self, query_type):
        """ä¼˜åŒ–æŸ¥è¯¢ç­–ç•¥"""
        if query_type == "large_dataset":
            return {
                "use_index": True,
                "batch_size": self.tune_batch_size(),
                "cache_results": True
            }
        elif query_type == "real_time":
            return {
                "use_index": False,
                "batch_size": 1,
                "cache_results": False
            }
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

#### ç¯å¢ƒè¦æ±‚

```yaml
python: ">=3.8"
dependencies:
  - pytest>=7.0.0
  - pytest-cov>=4.0.0
  - black>=22.0.0
  - flake8>=5.0.0
  - mypy>=1.0.0
```

#### å®‰è£…å¼€å‘ç¯å¢ƒ

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-org/auto-file-classification.git
cd auto-file-classification

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -e .
pip install -r requirements-dev.txt

# å®‰è£…é¢„æäº¤é’©å­
pre-commit install
```

### ä»£ç è§„èŒƒ

#### ä»£ç é£æ ¼

```python
# ä½¿ç”¨Blackæ ¼å¼åŒ–ä»£ç 
black ods/review/ tests/test_review/

# ä½¿ç”¨Flake8æ£€æŸ¥ä»£ç è´¨é‡
flake8 ods/review/ tests/test_review/

# ä½¿ç”¨MyPyè¿›è¡Œç±»å‹æ£€æŸ¥
mypy ods/review/ tests/test_review/
```

#### å‘½åçº¦å®š

```python
# ç±»åï¼šPascalCase
class ReviewManager:
    pass

# æ–¹æ³•åï¼šsnake_case
def create_review_session(self, user_id=None):
    pass

# å¸¸é‡ï¼šUPPER_SNAKE_CASE
MAX_FILES_PER_SESSION = 100

# ç§æœ‰æ–¹æ³•ï¼šä»¥å•ä¸‹åˆ’çº¿å¼€å¤´
def _calculate_priority(self, file_info):
    pass
```

### å¼€å‘æµç¨‹

#### 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯

```bash
# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/enhanced-review-ui

# å®šæœŸåŒæ­¥ä¸»åˆ†æ”¯
git fetch origin
git rebase origin/main
```

#### 2. ç¼–å†™ä»£ç 

```python
# å®ç°æ–°åŠŸèƒ½
def enhanced_review_display(self, file_info):
    """å¢å¼ºçš„å®¡æ ¸æ˜¾ç¤ºåŠŸèƒ½"""
    # å®ç°ä»£ç 
    pass

# æ·»åŠ ç›¸åº”çš„æµ‹è¯•
def test_enhanced_review_display(self):
    """æµ‹è¯•å¢å¼ºçš„å®¡æ ¸æ˜¾ç¤º"""
    # æµ‹è¯•ä»£ç 
    pass
```

#### 3. ç¼–å†™æµ‹è¯•

```python
import unittest
from unittest.mock import Mock, patch

class TestEnhancedReviewDisplay(unittest.TestCase):
    def setUp(self):
        self.reviewer = InteractiveReviewer(config)

    def test_display_with_preview(self):
        """æµ‹è¯•å¸¦é¢„è§ˆçš„æ˜¾ç¤ºåŠŸèƒ½"""
        file_info = {
            "file_path": "/test/document.pdf",
            "content_preview": "This is a test document...",
            "category": "å·¥ä½œ"
        }

        with patch("builtins.print") as mock_print:
            self.reviewer.enhanced_review_display(file_info)

        # éªŒè¯é¢„è§ˆå†…å®¹è¢«æ˜¾ç¤º
        calls = [call[0][0] for call in mock_print.call_args_list]
        self.assertTrue(any("é¢„è§ˆ" in call for call in calls))
```

#### 4. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python tests/test_review/run_review_tests.py

# è¿è¡Œç‰¹å®šæµ‹è¯•
python tests/test_review/run_review_tests.py ReviewManager

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
python -m pytest tests/test_review/ --cov=ods.review --cov-report=html
```

#### 5. æäº¤ä»£ç 

```bash
# æ·»åŠ æ–‡ä»¶
git add .

# æäº¤æ›´æ”¹
git commit -m "feat: æ·»åŠ å¢å¼ºçš„å®¡æ ¸æ˜¾ç¤ºåŠŸèƒ½

- æ–°å¢enhanced_review_displayæ–¹æ³•
- æ”¯æŒæ–‡ä»¶å†…å®¹é¢„è§ˆ
- æ·»åŠ ç›¸åº”çš„å•å…ƒæµ‹è¯•
- æ›´æ–°æ–‡æ¡£"

# æ¨é€åˆ†æ”¯
git push origin feature/enhanced-review-ui
```

### æµ‹è¯•ç­–ç•¥

#### å•å…ƒæµ‹è¯•åŸåˆ™

1. **å•ä¸€èŒè´£**: æ¯ä¸ªæµ‹è¯•åªéªŒè¯ä¸€ä¸ªåŠŸèƒ½ç‚¹
2. **ç‹¬ç«‹æ€§**: æµ‹è¯•ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œä¸ä¾èµ–æ‰§è¡Œé¡ºåº
3. **å¯é‡å¤æ€§**: æµ‹è¯•ç»“æœç¨³å®šï¼Œä¸å—å¤–éƒ¨ç¯å¢ƒå½±å“
4. **å¿«é€Ÿæ‰§è¡Œ**: æµ‹è¯•è¿è¡Œæ—¶é—´æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…

#### æµ‹è¯•è¦†ç›–è¦æ±‚

- **æ ¸å¿ƒä¸šåŠ¡é€»è¾‘**: >95%
- **é”™è¯¯å¤„ç†è·¯å¾„**: >90%
- **è¾¹ç•Œæ¡ä»¶**: >85%
- **ç”¨æˆ·ç•Œé¢**: >80%

#### Mockä½¿ç”¨æŒ‡å—

```python
# æ­£ç¡®çš„Mockä½¿ç”¨
@patch('ods.review.review_manager.Database')
def test_review_manager_init(self, mock_db_class):
    """æµ‹è¯•ReviewManageråˆå§‹åŒ–"""
    mock_db_instance = Mock()
    mock_db_class.return_value = mock_db_instance

    manager = ReviewManager(self.config)

    # éªŒè¯ç±»è¢«æ­£ç¡®å®ä¾‹åŒ–
    mock_db_class.assert_called_once_with(self.config)
    self.assertEqual(manager.database, mock_db_instance)

# é¿å…è¿‡åº¦Mock
def test_review_decision_logic(self):
    """æµ‹è¯•å®¡æ ¸å†³ç­–é€»è¾‘ï¼ˆä½¿ç”¨çœŸå®å¯¹è±¡ï¼‰"""
    manager = ReviewManager(self.config)

    # åªmockå¤–éƒ¨ä¾èµ–
    with patch.object(manager, '_get_file_path_by_id', return_value='/test/file.pdf'):
        result = manager.record_review_decision(...)

    # éªŒè¯ä¸šåŠ¡é€»è¾‘
    self.assertTrue(result)
```

### æ–‡æ¡£æ›´æ–°

#### æ›´æ–°APIæ–‡æ¡£

```python
def enhanced_review_display(self, file_info, show_preview=True):
    """
    å¢å¼ºçš„å®¡æ ¸æ˜¾ç¤ºåŠŸèƒ½ã€‚

    Args:
        file_info (dict): æ–‡ä»¶ä¿¡æ¯å­—å…¸
        show_preview (bool): æ˜¯å¦æ˜¾ç¤ºå†…å®¹é¢„è§ˆ

    Returns:
        None

    Raises:
        ValueError: å½“file_infoæ ¼å¼ä¸æ­£ç¡®æ—¶

    Example:
        >>> reviewer.enhanced_review_display(file_info)
        ğŸ“„ æ–‡ä»¶: /path/to/document.pdf
        ğŸ“ é¢„è§ˆ: This is the content preview...
        ğŸ“‚ åˆ†ç±»: å·¥ä½œ
    """
    if not isinstance(file_info, dict):
        raise ValueError("file_info must be a dictionary")

    # å®ç°ä»£ç 
    pass
```

#### æ›´æ–°ç”¨æˆ·æ–‡æ¡£

```markdown
### å¢å¼ºçš„å®¡æ ¸æ˜¾ç¤º

æ–°ç‰ˆæœ¬çš„å®¡æ ¸ç•Œé¢ç°åœ¨æ”¯æŒæ–‡ä»¶å†…å®¹é¢„è§ˆåŠŸèƒ½ï¼š

```bash
ods review --preview
```

æ­¤åŠŸèƒ½å¯ä»¥ï¼š

- æ˜¾ç¤ºæ–‡ä»¶çš„å‰å‡ è¡Œå†…å®¹
- é«˜äº®æ˜¾ç¤ºå…³é”®ä¿¡æ¯
- æ”¯æŒä¸åŒæ–‡ä»¶æ ¼å¼çš„é¢„è§ˆ

```

### ä»£ç å®¡æŸ¥æ¸…å•

#### åŠŸèƒ½å®ç°

- [ ] åŠŸèƒ½éœ€æ±‚æ˜¯å¦å®Œå…¨å®ç°
- [ ] ä»£ç æ˜¯å¦éµå¾ªé¡¹ç›®è§„èŒƒ
- [ ] æ˜¯å¦æœ‰è¶³å¤Ÿçš„é”™è¯¯å¤„ç†
- [ ] æ€§èƒ½æ˜¯å¦æ»¡è¶³è¦æ±‚

#### æµ‹è¯•è¦†ç›–

- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ >90%
- [ ] è¾¹ç•Œæ¡ä»¶æµ‹è¯•å®Œæ•´
- [ ] é”™è¯¯åœºæ™¯æµ‹è¯•å……åˆ†
- [ ] é›†æˆæµ‹è¯•é€šè¿‡

#### æ–‡æ¡£æ›´æ–°

- [ ] APIæ–‡æ¡£æ›´æ–°
- [ ] ç”¨æˆ·æ–‡æ¡£æ›´æ–°
- [ ] ä»£ç æ³¨é‡Šå®Œæ•´
- [ ] å˜æ›´æ—¥å¿—æ›´æ–°

#### å…¼å®¹æ€§

- [ ] å‘åå…¼å®¹æ€§æ£€æŸ¥
- [ ] ä¾èµ–ç‰ˆæœ¬å…¼å®¹
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] é…ç½®å…¼å®¹æ€§

### å‘å¸ƒæµç¨‹

#### 1. ç‰ˆæœ¬ç®¡ç†

```bash
# æ›´æ–°ç‰ˆæœ¬å·
# ç¼–è¾‘ setup.py æˆ– pyproject.toml
version = "1.2.0"

# æ›´æ–°å˜æ›´æ—¥å¿—
# ç¼–è¾‘ CHANGELOG.md
## [1.2.0] - 2024-01-15
### æ–°å¢
- å¢å¼ºçš„å®¡æ ¸æ˜¾ç¤ºåŠŸèƒ½
- æ–‡ä»¶å†…å®¹é¢„è§ˆæ”¯æŒ
### ä¿®å¤
- ä¿®å¤å®¡æ ¸ç•Œé¢ç¼–ç é—®é¢˜
```

#### 2. å‘å¸ƒå‡†å¤‡

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
python tests/test_review/run_review_tests.py
python -m pytest tests/ --cov --cov-report=html

# æ„å»ºæ–‡æ¡£
cd docs
make html

# æ£€æŸ¥ä»£ç è´¨é‡
black --check .
flake8 .
mypy .
```

#### 3. åˆ›å»ºå‘å¸ƒ

```bash
# åˆ›å»ºå‘å¸ƒæ ‡ç­¾
git tag -a v1.2.0 -m "Release version 1.2.0"

# æ¨é€æ ‡ç­¾
git push origin v1.2.0

# åˆ›å»ºGitHub Release
# åœ¨GitHubç•Œé¢åˆ›å»ºReleaseï¼Œé™„ä¸Šå˜æ›´æ—¥å¿—
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ä¸»é¡µ**: <https://github.com/your-org/auto-file-classification>
- **é—®é¢˜åé¦ˆ**: <https://github.com/your-org/auto-file-classification/issues>
- **é‚®ä»¶åˆ—è¡¨**: <project-maintainers@example.com>
- **æ–‡æ¡£ç«™ç‚¹**: <https://docs.example.com/auto-file-classification/>

---

*æœ€åæ›´æ–°: 2024-01-15* | *ç‰ˆæœ¬: 1.1.0* | *ç»´æŠ¤è€…: AI Assistant*
